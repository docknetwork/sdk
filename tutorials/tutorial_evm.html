<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>EVM - Dock SDK Tutorial</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="concepts.html"><strong aria-hidden="true">2.</strong> Concepts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="concepts_did.html"><strong aria-hidden="true">2.1.</strong> DID</a></li><li class="chapter-item expanded "><a href="concepts_vcdm.html"><strong aria-hidden="true">2.2.</strong> Verifiable credentials and presentations</a></li><li class="chapter-item expanded "><a href="concepts_blobs_schemas.html"><strong aria-hidden="true">2.3.</strong> Schema</a></li><li class="chapter-item expanded "><a href="concepts_claim_deduction.html"><strong aria-hidden="true">2.4.</strong> Claim Deduction</a></li><li class="chapter-item expanded "><a href="concepts_poe_anchors.html"><strong aria-hidden="true">2.5.</strong> PoE Anchors</a></li><li class="chapter-item expanded "><a href="concepts_private_delegation.html"><strong aria-hidden="true">2.6.</strong> Private Delegation</a></li><li class="chapter-item expanded "><a href="concepts_public_attestation.html"><strong aria-hidden="true">2.7.</strong> Public Attestation</a></li><li class="chapter-item expanded "><a href="concepts_public_delegation.html"><strong aria-hidden="true">2.8.</strong> Public Delegation</a></li></ol></li><li class="chapter-item expanded "><a href="tutorials.html"><strong aria-hidden="true">3.</strong> Tutorials</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="tutorial_did.html"><strong aria-hidden="true">3.1.</strong> DID</a></li><li class="chapter-item expanded "><a href="tutorial_resolver.html"><strong aria-hidden="true">3.2.</strong> DID Resolver</a></li><li class="chapter-item expanded "><a href="tutorial_ipv.html"><strong aria-hidden="true">3.3.</strong> Credentials - Issuance, Presentation, Verification</a></li><li class="chapter-item expanded "><a href="tutorial_revocation.html"><strong aria-hidden="true">3.4.</strong> Revocation</a></li><li class="chapter-item expanded "><a href="tutorial_blobs_schemas.html"><strong aria-hidden="true">3.5.</strong> Schema</a></li><li class="chapter-item expanded "><a href="tutorial_claim_deduction.html"><strong aria-hidden="true">3.6.</strong> Claim Deduction</a></li><li class="chapter-item expanded "><a href="tutorial_poe_anchors.html"><strong aria-hidden="true">3.7.</strong> PoE Anchors</a></li><li class="chapter-item expanded "><a href="tutorial_private_delegation.html"><strong aria-hidden="true">3.8.</strong> Private Delegation</a></li><li class="chapter-item expanded "><a href="tutorial_public_delegation.html"><strong aria-hidden="true">3.9.</strong> Public Delegation</a></li><li class="chapter-item expanded "><a href="tutorial_evm.html" class="active"><strong aria-hidden="true">3.10.</strong> EVM</a></li><li class="chapter-item expanded "><a href="tutorial_anoncreds.html"><strong aria-hidden="true">3.11.</strong> Anonymous credentials using BBS+ signatures and accumulators</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Dock SDK Tutorial</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ethereum-integration"><a class="header" href="#ethereum-integration">Ethereum integration</a></h1>
<h2 id="table-of-contents"><a class="header" href="#table-of-contents">Table of contents</a></h2>
<ol>
<li><a href="#intro">Intro</a></li>
<li><a href="#dock-and-evm-accounts">Dock and EVM accounts</a></li>
<li><a href="#dao">Deploying a DAO</a></li>
<li><a href="#chainlink">Chainlink integration</a></li>
</ol>
<p><strong>This document assumes hands-on experience with Ethereum and interaction with smart contracts using libraries like <a href="https://github.com/ChainSafe/web3.js">web3</a> or <a href="https://github.com/ethers-io/ethers.js">ethers-js</a>.</strong></p>
<h2 id="intro"><a class="header" href="#intro">Intro</a></h2>
<p>The chain allows you to deploy and interact with existing EVM smart contracts by using popular Ethereum client libraries like <a href="https://github.com/ChainSafe/web3.js">web3</a> or <a href="https://github.com/ethers-io/ethers.js">ethers-js</a>.
You can directly send contract's bytecode as well if you don't want to use these libraries. This is possible because the chain integrates 2 modules <a href="https://github.com/paritytech/frontier/tree/master/frame/evm">pallet-evm</a> and <a href="https://github.com/paritytech/frontier/tree/master/frame/ethereum">pallet-ethereum</a> from <a href="https://github.com/paritytech/frontier">Parity's frontier</a> project.
<code>pallet-evm</code> allows the chain to execute EVM bytecode and persist state like contract storage but does not understand how Ethereum transactions, blocks, etc are created and have to be parsed. Handling that is the job of <code>pallet-ethereum</code> which uses <code>pallet-evm</code> for executing the bytecode. More detailed docs of these pallets are available <a href="https://github.com/paritytech/frontier/tree/master/docs/frame">here</a>.</p>
<p>The motivation for this integration was to support <a href="https://chain.link/">Chainlink</a> for providing <a href="https://docs.chain.link/docs/using-chainlink-reference-contracts">price feed</a> of the DOCK/USD pair which can then be used by the chain to charge transactions at a USD price.</p>
<p>The document will however show how to deploy and use a different set of contracts. A <a href="https://academy.binance.com/en/glossary/decentralized-autonomous-organization">DAO</a>, which replicates <a href="https://github.com/aragon/aragon-apps/tree/master/apps/voting">Aragon's voting app</a>. The app lets token holders vote in proportion to the tokens they hold and the winning vote executes an action by calling a method on another contract.</p>
<p>Most of the examples use web-3 but there is <a href="../../tests/integration/eth/using-ethers.test.js">a test</a> using ethers-js as well.</p>
<h2 id="dock-and-evm-accounts"><a class="header" href="#dock-and-evm-accounts">Dock and EVM accounts</a></h2>
<p>Accounts in Dock are 32 bytes (excluding network identifier and checksum) but EVM accounts are 20 bytes (last 20 bytes of the public key). As there is no direct conversion possible between these two and we don't support
binding these two together in an onchain mapping, a separate Ethereum address has to be created and funded with tokens to send Ethereum style transactions. <code>pallet-evm</code> derives a Dock address from this Ethereum address
and expects that Dock address to have tokens. The test <a href="../../tests/integration/eth/native-balance-to-eth.test.js">native-balance-to-eth.test</a> shows an Ethereum account <code>carol</code> created using web3 being given some tokens using function <code>endowEVMAddress</code>.</p>
<pre><code class="language-js">  // An API object which will connect to node and send non-EVM transactions like balance transfer
  const dock = new DockAPI();
  await dock.init({
    address: FullNodeEndpoint,
  });

  // Jacob has Dock tokens and will send tokens to Carol.
  const jacob = dock.keyring.addFromUri(EndowedSecretURI);
  dock.setAccount(jacob);

  // ...
  // ....

  const carol = &quot;&lt;Account created from web3&gt;&quot;;
  await endowEVMAddress(dock, carol.address);
</code></pre>
<p>The substrate address can also be generated by function <code>evmAddrToSubstrateAddr</code>. Its balance can be queried either using <code>web3</code> or <code>polkadot-js</code>.</p>
<pre><code class="language-js">  // Every EVM address has a mapping to Substrate address whose balance is deducted for fee when the EVM address does a transaction.
  const carolSubsAddr = evmAddrToSubstrateAddr(carol.address);
  console.log(`Querying balance of Carol's address using web3 ${(await web3.eth.getBalance(carol.address))}`);
  console.log(`Querying balance of Carol's address using polkadot-js ${(await getBalance(dock.api, carolSubsAddr, false))}`);
</code></pre>
<p><code>endowEVMAddress</code> uses <code>evmAddrToSubstrateAddr</code> to covert the passed EVM address to the Substrate address and do a <code>transfer</code> as shown below</p>
<pre><code class="language-js">// Give `amount` of Dock tokens to EVM address. `amount` defaults to the number of tokens required to pay of maximum gas
export function endowEVMAddress(dock, evmAddr, amount) {
  //  Convert EVM address to a Substrate address
  const substrateAddr = evmAddrToSubstrateAddr(evmAddr);

  // Selecting the amount such that it can pay fees for the upto the maximum gas allowed and some extra
  const amt = amount !== undefined ? amount : bnToBn(MinGasPrice).mul(bnToBn(MaxGas)).muln(2);

  // Transfer to the Substrate address created above
  const transfer = dock.api.tx.balances.transfer(substrateAddr, amt);
  return dock.signAndSend(transfer, false);
}
</code></pre>
<p>To send arbitrary EVM transactions and deploy contracts using web3, look at the functions <code>sendEVMTxn</code> and <code>deployContract</code> respectively in <code>scripts/eth/helpers.js</code>.</p>
<p>Withdrawing tokens back from an EVM address to a Substrate address is a 3-step process.</p>
<ol>
<li>Derive an intermediate EVM address from the receiving Substrate address.</li>
<li>Send tokens using web3 to this intermediate EVM address.</li>
<li>Send tokens using polkadot-js from intermediate address to target address.</li>
</ol>
<pre><code class="language-js">  // Withdraw some tokens from EVM address, i.e. Carol to Jacob.

  // Jacob's account is set as signer in the API object `dock`

  // Step-1
  // Create an intermediate EVM address
  const intermediateAddress = substrateAddrToEVMAddr(jacob.address);

  // Step-2
  // Carol sends 100 tokens to the intermediate EVM address. `sendTokensToEVMAddress` uses web3 to send an Ethereum style
  // transfer transaction, i.e. `data` field is set to 0 and `value` field specifies the transfer amount.
  await sendTokensToEVMAddress(web3, carol, intermediateAddress, 1000);

  // Step-3
  // Withdraw from the intermediate address to the Substrate address sending this transaction, i.e. Jacob
  const withdraw = dock.api.tx.evm.withdraw(intermediateAddress, 1000);
  await dock.signAndSend(withdraw, false);
</code></pre>
<p>The second step above of sending tokens in EVM requires to specify minimum gas price and maximum allowed gas. The function <code>sendTokensToEVMAddress</code> needs to
know these values and accepts them as arguments. If not provided it will check for environment variables <code>MinGasPrice</code> and <code>MaxGas</code>. This behavior is
common to all script helpers.</p>
<h2 id="dao"><a class="header" href="#dao">DAO</a></h2>
<p>This section shows how to deploy a voting DAO where tokens holder can vote to execute certain actions. This replicates <a href="https://github.com/aragon/aragon-apps/tree/master/apps/voting">Aragon's voting app</a>.
The complete script is <a href="../../scripts/eth/dao/voting-dao-test.js">here</a> and below is an explainer of the script</p>
<ol>
<li>
<p>Create some accounts that will send Ethereum style transactions and fund them with Dock tokens. The accounts generated in the code are only for testing
so create your own accounts for real world apps.</p>
<pre><code class="language-js">const web3 = getWeb3();

// Create some test accounts. Alice will be the manager of the DAO while Bob, Carol and Dave will be voters.
const [alice, bob, carol, dave] = getTestEVMAccountsFromWeb3(web3);

// Endow accounts with tokens so they can pay fees for transactions
await endowEVMAddressWithDefault(alice.address);
await endowEVMAddressWithDefault(bob.address);
await endowEVMAddressWithDefault(carol.address);
await endowEVMAddressWithDefault(dave.address);
</code></pre>
<p><code>getTestEVMAccountsFromWeb3</code> uses web3 to create EVM accounts using some test private keys.</p>
<pre><code class="language-js">// Returns some test EVM accounts
export function getTestEVMAccountsFromWeb3(web3) {
  return getTestPrivKeysForEVMAccounts().map((k) =&gt; web3.eth.accounts.privateKeyToAccount(k));
}
</code></pre>
</li>
<li>
<p>Create a DAO factory contract which will then be used to initialize a new DAO instance. Also setup the access control list for the DAO and set the DAO manager (an admin role)</p>
<pre><code class="language-js">// Create a contract factory to create new DAO instance.
const [, , , daoFactContractAddr] = await createDaoFactory(web3, alice);

// Create a new DAO instance
const daoAddr = await createNewDao(web3, alice, alice.address, daoFactContractAddr);

// Set access control and set Alice as DAO's manager
const aclAddr = await setupAcl(web3, alice, alice.address, daoAddr);
</code></pre>
</li>
<li>
<p>A DAO can install several apps but here we will have only one app; for voting. Choose a unique app id.</p>
<pre><code class="language-js">// Some unique app id
const appId = '0x0000000000000000000000000000000000000000000000000000000000000100';
</code></pre>
</li>
<li>
<p>Create a voting app (contract) with the above app id. Install the app in the DAO and allow any token holder to vote using the DAO's access control list (ACL).</p>
<pre><code class="language-js">// Create a voting contract, install it as an app in the DAO and allow any token holder to vote
const votingAppAddress = await setupVotingApp(web3, alice, alice.address, appId, daoAddr, aclAddr);
const votingApp = new web3.eth.Contract(VotingDAOABI, votingAppAddress);
</code></pre>
</li>
<li>
<p>Voting in this DAO requires voters to have tokens and their vote will carry weight proportional to their token balance. Deploy a token contract. This token contract is
<a href="https://github.com/aragon/minime/blob/master/contracts/MiniMeToken.sol">Aragon's MiniMeToken</a> that extends ERC-20 interface. After deploying token, accounts <code>bob</code>, <code>carol</code>
and <code>dave</code> are given 51, 29 and 20 tokens respectively. This makes the total supply of the <code>MiniMeToken</code> as 100 where <code>bob</code>, <code>carol</code> and <code>dave</code> hold 51%, 29% and 20% supply
respectively.</p>
<pre><code class="language-js">// Deploy a token contract where Bob, Carol and Dave will have 51%, 29% and 20% tokens as thus proportional voting power.
const tokenContractAddr = await deployToken(web3, alice, [[bob.address, 51], [carol.address, 29], [dave.address, 20]]);
</code></pre>
</li>
<li>
<p>Now initialize the voting app by setting the token contract address and thresholds for voting. The example scripts set the winning percentage to 51%.
As <code>bob</code>, <code>carol</code> and <code>dave</code> hold 51%, 29% and 20% token supply, they will have 51%, 29% and 20% voting power respectively.</p>
<pre><code class="language-js">// Initialize the voting by supplying the token contract and thresholds for voting.
await initializeVotingApp(web3, alice, votingAppAddress, tokenContractAddr);
</code></pre>
</li>
<li>
<p>For this example, we want successful voting to increment a counter in a contract. However, this contract is for demo purpose only. <code>counterAddr</code> is the
address of the demo contract and <code>incrementScript</code> is the encoded call to a function to increment the counter.</p>
<pre><code class="language-js">// A Counter contract as an example executor. In practice, the executor methods will only allow calls by the voting contract.
const [counterAddr, incrementScript] = await setupVotingExecutor(web3, alice);
</code></pre>
</li>
<li>
<p>As <code>bob</code> has 51% of the voting power, it can create a new vote by calling contract method <code>newVote</code></p>
<pre><code class="language-js">// Bob alone can increment the Counter as he has 51% tokens
console.log(`Counter before increment from Bob ${(await getCounter(web3, counterAddr))}`);
await sendEVMTxn(web3, bob, votingAppAddress, votingApp.methods.newVote(incrementScript, '').encodeABI());
console.log(`Counter after increment from Bob ${(await getCounter(web3, counterAddr))}`);
</code></pre>
</li>
<li>
<p>As <code>carol</code> and <code>dave</code> together hold less than 51%, they cannot increment the counter by voting. Here <code>carol</code> creates a new vote by calling contract
method <code>newVote</code> which returns the vote id and dave uses votes in approval of <code>carol</code> by calling contract method <code>vote</code> and passing the vote id and <code>true</code>.
The other <code>true</code> indicates the vote should trigger the execution if successful.</p>
<pre><code class="language-js">// Carol creates a new vote
const voteId = await createNewVote(web3, carol, votingAppAddress, incrementScript);
// Dave seconds Carol's vote
await sendEVMTxn(web3, dave, votingAppAddress, votingApp.methods.vote(voteId, true, true).encodeABI());
console.log(&quot;Counter after attempted increment from Carol and Dave. Counter will not change as Bob and Carol don't have enough voting power&quot;);
</code></pre>
</li>
</ol>
<h2 id="chainlink"><a class="header" href="#chainlink">Chainlink</a></h2>
<p>The chain will have Chainlink contracts for price feed in addition to Link token and others. The contracts and scripts to interact
with Chainlink contracts are at <code>scripts/eth/chainlink</code> in the repo. The scripts have some comments to explain the working.</p>
<ul>
<li>To deploy the Link token, check the script <code>link-token.js</code> at path <code>scripts/eth/chainlink/link-token.js</code> in the repo.</li>
<li>To deploy the <a href="https://github.com/smartcontractkit/chainlink/blob/develop/evm-contracts/src/v0.6/FluxAggregator.sol">FluxAggregator</a> contract that is used by oracles to submit prices, check script <code>flux-aggegator.js</code> at path <code>scripts/eth/chainlink/flux-aggegator.js</code> in the repo.</li>
<li>To deploy aggregator with access control on reads and with proxy, <a href="https://github.com/smartcontractkit/chainlink/blob/develop/evm-contracts/src/v0.6/AccessControlledAggregator.sol">AccessControlledAggregator</a> and <a href="https://github.com/smartcontractkit/chainlink/blob/develop/evm-contracts/src/v0.6/EACAggregatorProxy.sol">EACAggregatorProxy</a> are deployed.
Check script <code>access-controlled-aggregator-proxy.js</code> at path <code>scripts/eth/chainlink/access-controlled-aggregator-proxy.js</code> in the repo. To deploy with <a href="https://github.com/smartcontractkit/chainlink/blob/develop/evm-contracts/src/v0.6/DeviationFlaggingValidator.sol">DeviationFlaggingValidator</a> that raises flag on price off by a threshold in either direction,
use script <code>deviation-flag-validator.js</code> at path <code>scripts/eth/chainlink/deviation-flag-validator.js</code>. The set the validator address while deploying <code>AccessControlledAggregator</code>.</li>
<li>To setup a contract for an Oracle (not needed for price feed though), check script <code>oracle.js</code> in <code>scripts/eth/chainlink/oracle.js</code>.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="tutorial_public_delegation.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="tutorial_anoncreds.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="tutorial_public_delegation.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="tutorial_anoncreds.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
