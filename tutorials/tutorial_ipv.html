<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Credentials - Issuance, Presentation, Verification - Dock SDK Tutorial</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="concepts.html"><strong aria-hidden="true">2.</strong> Concepts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="concepts_did.html"><strong aria-hidden="true">2.1.</strong> DID</a></li><li class="chapter-item expanded "><a href="concepts_vcdm.html"><strong aria-hidden="true">2.2.</strong> Verifiable credentials and presentations</a></li><li class="chapter-item expanded "><a href="concepts_blobs_schemas.html"><strong aria-hidden="true">2.3.</strong> Schema</a></li><li class="chapter-item expanded "><a href="concepts_claim_deduction.html"><strong aria-hidden="true">2.4.</strong> Claim Deduction</a></li><li class="chapter-item expanded "><a href="concepts_poe_anchors.html"><strong aria-hidden="true">2.5.</strong> PoE Anchors</a></li><li class="chapter-item expanded "><a href="concepts_private_delegation.html"><strong aria-hidden="true">2.6.</strong> Private Delegation</a></li><li class="chapter-item expanded "><a href="concepts_public_attestation.html"><strong aria-hidden="true">2.7.</strong> Public Attestation</a></li><li class="chapter-item expanded "><a href="concepts_public_delegation.html"><strong aria-hidden="true">2.8.</strong> Public Delegation</a></li></ol></li><li class="chapter-item expanded "><a href="tutorials.html"><strong aria-hidden="true">3.</strong> Tutorials</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="tutorial_did.html"><strong aria-hidden="true">3.1.</strong> DID</a></li><li class="chapter-item expanded "><a href="tutorial_resolver.html"><strong aria-hidden="true">3.2.</strong> DID Resolver</a></li><li class="chapter-item expanded "><a href="tutorial_ipv.html" class="active"><strong aria-hidden="true">3.3.</strong> Credentials - Issuance, Presentation, Verification</a></li><li class="chapter-item expanded "><a href="tutorial_revocation.html"><strong aria-hidden="true">3.4.</strong> Revocation</a></li><li class="chapter-item expanded "><a href="tutorial_blobs_schemas.html"><strong aria-hidden="true">3.5.</strong> Schema</a></li><li class="chapter-item expanded "><a href="tutorial_claim_deduction.html"><strong aria-hidden="true">3.6.</strong> Claim Deduction</a></li><li class="chapter-item expanded "><a href="tutorial_poe_anchors.html"><strong aria-hidden="true">3.7.</strong> PoE Anchors</a></li><li class="chapter-item expanded "><a href="tutorial_private_delegation.html"><strong aria-hidden="true">3.8.</strong> Private Delegation</a></li><li class="chapter-item expanded "><a href="tutorial_public_delegation.html"><strong aria-hidden="true">3.9.</strong> Public Delegation</a></li><li class="chapter-item expanded "><a href="tutorial_anoncreds.html"><strong aria-hidden="true">3.10.</strong> Anonymous credentials using BBS+ signatures and accumulators</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Dock SDK Tutorial</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="verifiable-credentials-and-verifiable-presentations-issuing-signing-and-verification"><a class="header" href="#verifiable-credentials-and-verifiable-presentations-issuing-signing-and-verification">Verifiable Credentials and Verifiable Presentations: issuing, signing and verification</a></h1>
<h2 id="table-of-contents"><a class="header" href="#table-of-contents">Table of contents</a></h2>
<ul>
<li><a href="#incremental-creation-and-verification-of-verifiable-credentials">Incremental creation and verification of VC</a>
<ul>
<li><a href="#building-a-verifiable-credential">Building a Verifiable Credential</a>
<ul>
<li><a href="#adding-a-context">Adding a Context</a></li>
<li><a href="#adding-a-type">Adding a Type</a></li>
<li><a href="#adding-a-subject">Adding a Subject</a></li>
<li><a href="#setting-a-status">Setting a Status</a></li>
<li><a href="#setting-the-issuance-date">Setting the Issuance Date</a></li>
<li><a href="#setting-an-expiration-date">Setting an Expiration Date</a></li>
</ul>
</li>
<li><a href="#signing-a-verifiable-credential">Signing a Verifiable Credential</a></li>
<li><a href="#verifying-a-verifiable-credential">Verifying a Verifiable Credential</a></li>
</ul>
</li>
<li><a href="#incremental-creation-and-verification-of-verifiable-presentations">Incremental creation and verification of VP</a>
<ul>
<li><a href="#building-a-verifiable-presentation">Building a Verifiable Presentation</a>
<ul>
<li><a href="#adding-a-context">Adding a Context</a></li>
<li><a href="#adding-a-type">Adding a Type</a></li>
<li><a href="#setting-a-holder">Setting a Holder</a></li>
<li><a href="#adding-a-verifiable-credential">Adding a Verifiable Credential</a></li>
</ul>
</li>
<li><a href="#signing-a-verifiable-presentation">Signing a Verifiable Presentation</a></li>
<li><a href="#verifying-a-verifiable-presentation">Verifying a Verifiable Presentation</a></li>
</ul>
</li>
<li><a href="#using-dids">Using DIDs</a></li>
<li><a href="#creating-a-keydoc">Creating a keyDoc</a></li>
</ul>
<hr />
<h2 id="incremental-creation-and-verification-of-verifiable-credentials"><a class="header" href="#incremental-creation-and-verification-of-verifiable-credentials">Incremental creation and verification of Verifiable Credentials</a></h2>
<p>The <code>client-sdk</code> exposes a <code>VerifiableCredential</code> class that is useful to incrementally create valid Verifiable Credentials of any type, sign them and verify them.
Once the credential is initialized, you can sequentially call the different methods provided by the class to add contexts, types, issuance dates and everything else.</p>
<h3 id="building-a-verifiable-credential"><a class="header" href="#building-a-verifiable-credential">Building a Verifiable Credential</a></h3>
<p>The first step to build a Verifiable Credential is to initialize it, we can do that using the <code>VerifiableCredential</code> class constructor which takes a <code>credentialId</code> as sole argument:</p>
<pre><code class="language-javascript">let vc = new VerifiableCredential("http://example.edu/credentials/2803");
</code></pre>
<p>You now have an unsigned Verifiable Credential in the <code>vc</code> variable!
This Credential isn't signed since we only just initialized it. It brings however some useful defaults to make your life easier.</p>
<pre><code class="language-javascript">&gt;    vc.context
&lt;-   ["https://www.w3.org/2018/credentials/v1"]
&gt;    vc.issuanceDate
&lt;-   "2020-04-14T14:48:48.486Z"
&gt;    vc.type
&lt;-   ["VerifiableCredential"]
&gt;    vc.credentialSubject
&lt;-   []
</code></pre>
<p>The default <code>context</code> is an array with
<code>"https://www.w3.org/2018/credentials/v1"</code> as first element. This is required
by the VCDMv1 specs so having it as default helps ensure your Verifiable
Credentials will be valid in the end.</p>
<p>A similar approach was taken on the <code>type</code> property, where the default is an
array with <code>"VerifiableCredential"</code> already populated. This is also required
by the specs. The <code>subject</code> property is required to exist, so this is already
initialized for you as well although it is empty for now. Finally the
<code>issuanceDate</code> is also set to the moment you initialized the
<code>VerifiableCredential</code> object. You can change this later if desired but it
helps having it in the right format from the get go.</p>
<p>We could also have checked those defaults more easily by checking the
Verifiable Credential's JSON representation.</p>
<p>This can be achieved by calling the <code>toJSON()</code> method on it:</p>
<pre><code class="language-javascript">&gt;    vc.toJSON()
&lt;-   {
       "@context": [ "https://www.w3.org/2018/credentials/v1" ],
       "credentialSubject": [],
       "id": "http://example.edu/credentials/2803",
       "type": [
         "VerifiableCredential"
       ],
       "issuanceDate": "2020-04-14T14:48:48.486Z"
     }
</code></pre>
<p>An interesting thing to note here is the transformation happening to some of
the root level keys in the JSON representation of a <code>VerifiableCredential</code>
object.</p>
<p>For example <code>context</code> gets transformed into <code>@context</code> and <code>subject</code>
into <code>credentialSubject</code>.</p>
<p>This is to ensure compliance with the Verifiable Credential Data Model specs
while at the same time providing you with a clean interface to the
<code>VerifiableCredential</code> class in your code.</p>
<p>Once your Verifiable Credential has been initialized, you can proceed to use
the rest of the building functions to define it completely before finally
signing it.</p>
<h4 id="adding-a-context"><a class="header" href="#adding-a-context">Adding a Context</a></h4>
<p>A context can be added with the <code>addContext</code> method. It accepts a single argument <code>context</code> which can either be a string (in which case it needs to be a valid URI), or an object:</p>
<pre><code class="language-javascript">&gt;   vc.addContext('https://www.w3.org/2018/credentials/examples/v1')
&gt;   vc.context
&lt;-  [
      'https://www.w3.org/2018/credentials/v1',
      'https://www.w3.org/2018/credentials/examples/v1'
    ])
</code></pre>
<h4 id="adding-a-type"><a class="header" href="#adding-a-type">Adding a Type</a></h4>
<p>A type can be added with the <code>addType</code> function. It accepts a single argument <code>type</code> that needs to be a string:</p>
<pre><code class="language-javascript">&gt;   vc.addType('AlumniCredential')
&gt;   vc.type
&lt;-  [
      'VerifiableCredential',
      'AlumniCredential'
    ]
</code></pre>
<h4 id="adding-a-subject"><a class="header" href="#adding-a-subject">Adding a Subject</a></h4>
<p>A subject can be added with the <code>addSubject</code> function. It accepts a single argument <code>subject</code> that needs to be an object with an <code>id</code> property:</p>
<pre><code class="language-javascript">&gt;   vc.addSubject({ id: 'did:dock:123qwe123qwe123qwe', alumniOf: 'Example University' })
&gt;   vc.credentialSubject
&lt;-  {id: 'did:dock:123qwe123qwe123qwe', alumniOf: 'Example University'}
</code></pre>
<h4 id="setting-a-status"><a class="header" href="#setting-a-status">Setting a Status</a></h4>
<p>A status can be set with the <code>setStatus</code> function. It accepts a single argument <code>status</code> that needs to be an object with an <code>id</code> property:</p>
<pre><code class="language-javascript">&gt;   vc.setStatus({ id: "https://example.edu/status/24", type: "CredentialStatusList2017" })
&gt;   vc.status
&lt;-  {
        "id": "https://example.edu/status/24",
        "type": "CredentialStatusList2017"
    }
</code></pre>
<h4 id="setting-the-issuance-date"><a class="header" href="#setting-the-issuance-date">Setting the Issuance Date</a></h4>
<p>The issuance date is set by default to the datetime you first initialize your
<code>VerifiableCredential</code> object.</p>
<p>This means that you don't necessarily need to
call this method to achieve a valid Verifiable Credential (which are required
to have an issuanceDate property).</p>
<p>However, if you need to change this date you can use the <code>setIssuanceDate</code>
method. It takes a single argument <code>issuanceDate</code> that needs to be a string
with a valid ISO formatted datetime:</p>
<pre><code class="language-javascript">&gt;   vc.issuanceDate
&lt;-  "2020-04-14T14:48:48.486Z"
&gt;   vc.setIssuanceDate("2019-01-01T14:48:48.486Z")
&gt;   vc.issuanceDate
&lt;-  "2019-01-01T14:48:48.486Z"
</code></pre>
<h4 id="setting-an-expiration-date"><a class="header" href="#setting-an-expiration-date">Setting an Expiration Date</a></h4>
<p>An expiration date is not set by default as it isn't required by the specs.
If you wish to set one, you can use the <code>setExpirationDate</code> method.</p>
<p>It takes a single argument <code>expirationDate</code> that needs to be a string with a
valid ISO formatted datetime:</p>
<pre><code class="language-javascript">&gt;   vc.setExpirationDate("2029-01-01T14:48:48.486Z")
&gt;   vc.expirationDate
&lt;-  "2029-01-01T14:48:48.486Z"
</code></pre>
<h3 id="signing-a-verifiable-credential"><a class="header" href="#signing-a-verifiable-credential">Signing a Verifiable Credential</a></h3>
<p>Once you've crafted your Verifiable Credential it is time to sign it. This
can be achieved with the <code>sign</code> method.</p>
<p>It requires a <code>keyDoc</code> parameter (an object with the params and keys you'll
use for signing) and it also accepts a boolean <code>compactProof</code> that determines
whether you want to compact the JSON-LD or not:</p>
<pre><code class="language-javascript">&gt;   await vc.sign(keyDoc)
</code></pre>
<p>Please note that signing is an async process.
Once done, your <code>vc</code> object will have a new <code>proof</code> field:</p>
<pre><code class="language-javascript">&gt;   vc.proof
&lt;-  {
        type: "EcdsaSecp256k1Signature2019",
        created: "2020-04-14T14:48:48.486Z",
        jws: "eyJhbGciOiJFUzI1NksiLCJiNjQiOmZhbHNlLCJjcml0IjpbImI2NCJdfQ..MEQCIAS8ZNVYIni3oShb0TFz4SMAybJcz3HkQPaTdz9OSszoAiA01w9ZkS4Zx5HEZk45QzxbqOr8eRlgMdhgFsFs1FnyMQ",
        proofPurpose: "assertionMethod",
        verificationMethod: "https://gist.githubusercontent.com/faustow/13f43164c571cf839044b60661173935/raw"
    }
</code></pre>
<h3 id="verifying-a-verifiable-credential"><a class="header" href="#verifying-a-verifiable-credential">Verifying a Verifiable Credential</a></h3>
<p>Once your Verifiable Credential has been signed you can proceed to verify it
with the <code>verify</code> method. The <code>verify</code> method takes an object of arguments,
and is optional.</p>
<p>If you've used DIDs you need to pass a <code>resolver</code> for them.
You can also use the booleans <code>compactProof</code> (to compact the JSON-LD).</p>
<p>If your credential has uses the <code>credentialStatus</code> field, the credential will be checked
not to be revoked unless you pass <code>skipRevocationCheck</code> flag.</p>
<pre><code class="language-javascript">&gt;   const result = await vc.verify({ ... })
&gt;   result
&lt;-  {
      verified: true,
      results: [
        {
          proof: [
            {
                '@context': 'https://w3id.org/security/v2',
                type: "EcdsaSecp256k1Signature2019",
                created: "2020-04-14T14:48:48.486Z",
                jws: "eyJhbGciOiJFUzI1NksiLCJiNjQiOmZhbHNlLCJjcml0IjpbImI2NCJdfQ..MEQCIAS8ZNVYIni3oShb0TFz4SMAybJcz3HkQPaTdz9OSszoAiA01w9ZkS4Zx5HEZk45QzxbqOr8eRlgMdhgFsFs1FnyMQ",
                proofPurpose: "assertionMethod",
                verificationMethod: "https://gist.githubusercontent.com/faustow/13f43164c571cf839044b60661173935/raw"
            }
          ],
          verified: true
        }
      ]
    }
</code></pre>
<p>Please note that the verification is an async process that returns an object
when the promise resolves. A boolean value for the entire verification
process can be checked at the root level <code>verified</code> property.</p>
<hr />
<h2 id="incremental-creation-and-verification-of-verifiable-presentations"><a class="header" href="#incremental-creation-and-verification-of-verifiable-presentations">Incremental creation and verification of Verifiable Presentations</a></h2>
<p>The <code>client-sdk</code> exposes a <code>VerifiablePresentation</code> class that is useful to
incrementally create valid Verifiable Presentations of any type, sign them
and verify them.</p>
<p>Once the presentation is initialized, you can sequentially call the different
methods provided by the class to add <code>contexts</code>, <code>types</code>, <code>holders</code> and
<code>credentials</code>.</p>
<h3 id="building-a-verifiable-presentation"><a class="header" href="#building-a-verifiable-presentation">Building a Verifiable Presentation</a></h3>
<p>The first step to build a Verifiable Presentation is to initialize it, we can
do that using the <code>VerifiablePresentation</code> class constructor which takes an
<code>id</code> as sole argument:</p>
<pre><code class="language-javascript">let vp = new VerifiablePresentation("http://example.edu/credentials/1986");
</code></pre>
<p>You now have an unsigned Verifiable Presentation in the <code>vp</code> variable!</p>
<p>This Presentation isn't signed since we only just initialized it. It brings
however some useful defaults to make your life easier.</p>
<pre><code class="language-javascript">&gt;    vp.context
&lt;-   ["https://www.w3.org/2018/credentials/v1"]
&gt;    vp.type
&lt;-   ["VerifiablePresentation"]
&gt;    vp.credentials
&lt;-   []
</code></pre>
<p>The default <code>context</code> is an array with
<code>"https://www.w3.org/2018/credentials/v1"</code> as first element. This is required
by the VCDMv1 specs so having it as default helps ensure your Verifiable
Presentations will be valid in the end.</p>
<p>A similar approach was taken on the <code>type</code> property, where the default is an
array with <code>"VerifiablePresentation"</code> already populated. This is also
required by the specs.</p>
<p>The <code>credentials</code> property is required to exist, so this is already
initialized for you as well although it is empty for now.</p>
<p>We could also have checked those defaults more easily by checking the
Verifiable Presentation's JSON representation.</p>
<p>This can be achieved by calling the <code>toJSON()</code> method on it:</p>
<pre><code class="language-javascript">&gt;    vp.toJSON()
&lt;-   {
       "@context": [ "https://www.w3.org/2018/credentials/v1" ],
       "id": "http://example.edu/credentials/1986",
       "type": [
         "VerifiablePresentation"
       ],
       "verifiableCredential": [],
     }
</code></pre>
<p>An interesting thing to note here is the transformation happening to some of
the root level keys in the JSON representation of a <code>VerifiablePresentation</code>
object.</p>
<p>For example <code>context</code> gets transformed into <code>@context</code> and <code>credentials</code> into
<code>verifiableCredential</code>. This is to ensure compliance with the Verifiable
Credentials Data Model specs while at the same time providing you with a
clean interface to the <code>VerifiablePresentation</code> class in your code.</p>
<p>Once your Verifiable Presentation has been initialized, you can proceed to
use the rest of the building functions to define it completely before finally
signing it.</p>
<h4 id="adding-a-context-1"><a class="header" href="#adding-a-context-1">Adding a Context</a></h4>
<p>A context can be added with the <code>addContext</code> method. It accepts a single
argument <code>context</code> which can either be a string (in which case it needs to be
a valid URI), or an object</p>
<pre><code class="language-javascript">&gt;   vp.addContext('https://www.w3.org/2018/credentials/examples/v1')
&gt;   vp.context
&lt;-  [
      'https://www.w3.org/2018/credentials/v1',
      'https://www.w3.org/2018/credentials/examples/v1'
    ])
</code></pre>
<h4 id="adding-a-type-1"><a class="header" href="#adding-a-type-1">Adding a Type</a></h4>
<p>A type can be added with the <code>addType</code> function. It accepts a single argument <code>type</code> that needs to be a string:</p>
<pre><code class="language-javascript">&gt;   vp.addType('CredentialManagerPresentation')
&gt;   vp.type
&lt;-  [
      'VerifiablePresentation',
      'CredentialManagerPresentation'
    ]
</code></pre>
<h4 id="setting-a-holder"><a class="header" href="#setting-a-holder">Setting a Holder</a></h4>
<p>Setting a Holder is optional and it can be achieved using the <code>setHolder</code>
method. It accepts a single argument <code>type</code> that needs to be a string (a URI
for the entity that is generating the presentation):</p>
<pre><code class="language-javascript">&gt;   vp.setHolder('https://example.com/credentials/1234567890');
&gt;   vp.holder
&lt;-  'https://example.com/credentials/1234567890'
</code></pre>
<h4 id="adding-a-verifiable-credential"><a class="header" href="#adding-a-verifiable-credential">Adding a Verifiable Credential</a></h4>
<p>Your Verifiable Presentations can contain one or more Verifiable Credentials inside.</p>
<p>Adding a Verifiable Credential can be achieved using the <code>addCredential</code>
method. It accepts a single argument <code>credential</code> that needs to be an object
(a valid, signed Verifiable Credential):</p>
<pre><code class="language-javascript">&gt;   vp.addCredential(vc);
&gt;   vp.credentials
&lt;-  [
      {...}
    ]
</code></pre>
<p>Please note that the example was truncated to enhance readability.</p>
<h3 id="signing-a-verifiable-presentation"><a class="header" href="#signing-a-verifiable-presentation">Signing a Verifiable Presentation</a></h3>
<p>Once you've crafted your Verifiable Presentation and added your Verifiable
Credentials to it, it is time to sign it.</p>
<p>This can be achieved with the <code>sign</code> method. It requires a <code>keyDoc</code> parameter
(an object with the params and keys you'll use for signing), and a
<code>challenge</code> string for the proof.</p>
<p>It also accepts a <code>domain</code> string for the proof, a <code>resolver</code> in case you're
using DIDs and a boolean <code>compactProof</code> that determines whether you want to
compact the JSON-LD or not:</p>
<pre><code class="language-javascript">&gt;   await vp.sign(
          keyDoc,
          'some_challenge',
          'some_domain',
        );
</code></pre>
<p>Please note that signing is an async process.
Once done, your <code>vp</code> object will have a new <code>proof</code> field:</p>
<pre><code class="language-javascript">&gt;   vp.proof
&lt;-  {
      "type": "EcdsaSecp256k1Signature2019",
      "created": "2020-04-14T20:57:01Z",
      "challenge": "some_challenge",
      "domain": "some_domain",
      "jws": "eyJhbGciOiJFUzI1NksiLCJiNjQiOmZhbHNlLCJjcml0IjpbImI2NCJdfQ..MEUCIQCTTpivdcTKFDNdmzqe3l0nV6UjXgv0XvzCge--CTAV6wIgWfLqn_62U8jHkNSujrHFRmJ_ULj19b5rsNtjum09vbg",
      "proofPurpose": "authentication",
      "verificationMethod": "https://gist.githubusercontent.com/faustow/13f43164c571cf839044b60661173935/raw"
    }
</code></pre>
<h3 id="verifying-a-verifiable-presentation"><a class="header" href="#verifying-a-verifiable-presentation">Verifying a Verifiable Presentation</a></h3>
<p>Once your Verifiable Presentation has been signed you can proceed to verify
it with the <code>verify</code> method.</p>
<p>If you've used DIDs you need to pass a <code>resolver</code> for them. You can also use
the booleans <code>compactProof</code> (to compact the JSON-LD).</p>
<p>If your credential uses the <code>credentialStatus</code> field, the credential will be checked to be not revoked unless you pass <code>skipRevocationCheck</code>.
For the simplest cases you only need a <code>challenge</code> string and possibly a
<code>domain</code> string:</p>
<pre><code class="language-javascript">&gt;   const results = await vp.verify({ challenge: 'some_challenge', domain: 'some_domain' });
&gt;   results
&lt;-  {
      "presentationResult": {
        "verified": true,
        "results": [
          {
            "proof": {
              "@context": "https://w3id.org/security/v2",
              "type": "EcdsaSecp256k1Signature2019",
              "created": "2020-04-14T20:57:01Z",
              "challenge": "some_challenge",
              "domain": "some_domain",
              "jws": "eyJhbGciOiJFUzI1NksiLCJiNjQiOmZhbHNlLCJjcml0IjpbImI2NCJdfQ..MEUCIQCTTpivdcTKFDNdmzqe3l0nV6UjXgv0XvzCge--CTAV6wIgWfLqn_62U8jHkNSujrHFRmJ_ULj19b5rsNtjum09vbg",
              "proofPurpose": "authentication",
              "verificationMethod": "https://gist.githubusercontent.com/faustow/13f43164c571cf839044b60661173935/raw"
            },
            "verified": true
          }
        ]
      },
      "verified": true,
      "credentialResults": [
        {
          "verified": true,
          "results": [
            {
              "proof": {
                "@context": "https://w3id.org/security/v2",
                "type": "EcdsaSecp256k1Signature2019",
                "created": "2020-04-14T20:49:00Z",
                "jws": "eyJhbGciOiJFUzI1NksiLCJiNjQiOmZhbHNlLCJjcml0IjpbImI2NCJdfQ..MEUCIQCCCRuJbSUPePpOfkxsMJeQAqpydOFYWsA4cGiQRAR_QQIgehRZh8XE24hV0TPl5bMS6sNeKtC5rwZGfmflfY0eS-Y",
                "proofPurpose": "assertionMethod",
                "verificationMethod": "https://gist.githubusercontent.com/faustow/13f43164c571cf839044b60661173935/raw"
              },
              "verified": true
            }
          ]
        }
      ]
    }
</code></pre>
<p>Please note that the verification is an async process that returns an object
when the promise resolves.</p>
<p>This object contains separate results for the verification processes of the
included Verifiable Credentials and the overall Verifiable Presentation.</p>
<p>A boolean value for the entire verification process can be checked at the
root level <code>verified</code> property.</p>
<h2 id="using-dids"><a class="header" href="#using-dids">Using DIDs</a></h2>
<p>The examples shown above use different kinds of URIs as <code>id</code> property of
different sections. It is worth mentioning that the use of DIDs is not only
supported but also encouraged.</p>
<p>Their usage is very simple: create as many DIDs as you need and then use them instead of the URIs shown above.</p>
<p>For example when adding a subject to a Verifiable Credential here we're using a DID instead of a regular URI in the <code>id</code> property of the object:<code>vc.addSubject({ id: 'did:dock:123qwe123qwe123qwe', alumniOf: 'Example University' })</code>.</p>
<p>If you don't know how to create a DID there's a specific <a href="tutorial_did.html">tutorial on DIDs</a> you can read.</p>
<p>Bear in mind that you will need to provide a <code>resolver</code> method if you decide to use DIDs in your Verifiable Credentials or Verifiable Presentations. More on resolvers can be found in the <a href="tutorial_resolver.html">tutorial on Resolvers</a>.</p>
<p>Here's an example of issuing a Verifiable Credential using DIDs, provided that you've created and a DID that you store in <code>issuerDID</code>:</p>
<pre><code class="language-javascript">const issuerKey = getKeyDoc(
  issuerDID,
  dock.keyring.addFromUri(issuerSeed, null, "ed25519"),
  "Ed25519VerificationKey2018"
);
await vc.sign(issuerKey);
const verificationResult = await signedCredential.verify({
  resolver,
  compactProof: true,
});
console.log(verificationResult.verified); // Should print `true`
</code></pre>
<h2 id="creating-a-keydoc"><a class="header" href="#creating-a-keydoc">Creating a keyDoc</a></h2>
<p>It can be seen from the above examples that signing of credentials and
presentations require keypairs to be formatted into a <code>keyDoc</code> object.</p>
<p>There is a helper function to help with this formatting, it's called
<code>getKeyDoc</code> and it is located in the <code>vc</code> helpers.</p>
<p>Its usage is very simple, it accepts a <code>did</code> string which is a DID in fully
qualified form, a <code>keypair</code> object (generated by either using polkadot-js's
keyring for Sr25519 and Ed25519 or keypair generated with
<code>generateEcdsaSecp256k1Keypair</code> for curve secp256k1)
and a <code>type</code> string containing the type of the provided key (one of the
supported 'Sr25519VerificationKey2020', 'Ed25519VerificationKey2018' or
'EcdsaSecp256k1VerificationKey2019'):</p>
<pre><code class="language-javascript">const keyDoc = getKeyDoc(did, keypair, type);
</code></pre>
<p>Please check the example on the <a href="#using-dids">previous section</a> or refer to the <a href="../../tests/integration/presenting.test.js">presenting integration tests</a> for a live example.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="tutorial_resolver.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="tutorial_revocation.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="tutorial_resolver.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="tutorial_revocation.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
